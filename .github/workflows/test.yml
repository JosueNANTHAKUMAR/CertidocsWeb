name: GitHub to Discord

on:
  push:
    branches:
      - main
  pull_request:
    types: [opened, closed, merged]

jobs:
  discord_notification:
    name: Notify Discord
    runs-on: ubuntu-latest
    steps:
      - name: Send notification to Discord
        env:
            DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        uses: Ilshidur/action-discord@master
        with:
          args: |
            {
              "title": "🚀 GitHub Notification",
              "description": "**Un nouvel événement a eu lieu sur le repo !**",
              "color": 16776960,
              "author": {
                "name": "${{ github.actor }}",
                "icon_url": "https://github.com/${{ github.actor }}.png"
              },
              "fields": [
                { "name": "📂 Repository", "value": "[${{ github.repository }}](${{ github.event.repository.html_url }})", "inline": true },
                { "name": "📢 Event", "value": "${{ github.event_name }}", "inline": true },
                { "name": "👤 Actor", "value": "[${{ github.actor }}](https://github.com/${{ github.actor }})", "inline": true },
                { "name": "📝 Commit Message", "value": "`${{ github.event.head_commit.message || 'N/A' }}`", "inline": false },
                { "name": "🌿 Branch", "value": "`${{ github.ref }}`", "inline": true }
              ],
              "footer": {
                "text": "🔗 Voir sur GitHub",
                "icon_url": "https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png"
              },
            }